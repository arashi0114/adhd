# Prompt 

目标：训练多个模型并选出最优模型，任务是老年人群认知障碍的早筛（二分类）和发病时间预测（回归）。

## 环境和语言
- 使用 Python 3  
- 框架：PyTorch + scikit-learn + pandas + numpy + matplotlib / seaborn  
- 固定随机种子，保证实验可复现  

## 一、数据
- 数据路径：`data/cleaned`，取最新 CSV 文件  
- 数据大小：3803 * 1316  
- 列命名：`r{wave}{变量名}{标签标记}`  
  - wave：时间维度 1~9，‘a’ 表示非时间特征  
  - 标签：`racogimp_label`（早筛二分类，-1表示从未发病，其它数字表示第一次发病的wave），`r{wave}cogimpt_label`（发病时间回归）  

## 二、数据预处理
1. 缺失值处理：多重插补 5 重（IterativeImputer）  
2. 异常值处理：统计方法或 Z 分数法  
3. 标准化：StandardScaler  

## 三、模型

### 早筛（二分类）
- **深度学习**：Transformer、ResNet、AlexNet、MobileNet（输入为 tabular 数据，可用 MLP 替代卷积部分）  
- **传统 ML**：XGBoost、SVM、随机森林  

### 发病时间预测（回归）
- **深度学习**：MLP、RNN、LSTM、Transformer  
- **传统 ML**：Linear Regression、Random Forest Regressor、Gradient Boosting Regressor  

## 四、训练和评估
- 数据集划分：训练80%/验证10%/测试10%
- 分类指标：混淆矩阵、Accuracy、Precision、Recall、F1、PR 曲线、ROC、AUC  
- 回归指标：MSE、RMSE、MAE、R²  
- 计算开销指标：flops 训练时间、推理时间、参数量  

## 五、实验流程要求
我希望以下流程是可控的，我可以从中间的任何一个步骤开始，也可以停在中间任何一步。
1. 自动遍历所有模型并训练。需要输出保存每个模型的指标和可视化（混淆矩阵、ROC、PR 曲线、训练曲线），保存每个模型的最优的权重
2. 我可以选中任意一个模型进行分析评估，分析方法包括如下（无顺序）：
    1. 十折交叉验证  
    2. 统计分析：p 值、95% 置信区间  
    3. 可解释性分析（特征重要性、SHAP/Permutation）  
    4. 稳健性分析（分层分析、非响应分析、敏感性分析）  

## 六、输出要求
- 完整可运行 Python 代码，包含：  
  - 数据加载与预处理  
  - 模型定义与训练  
  - 评估与指标计算  
  - 可视化
  等等其它一切你认为需要的东西  
- 保证可复现性（随机种子、固定库版本）
